<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nahuel Electrohogar | Tienda de ElectrodomÃ©sticos</title>
  <link rel="stylesheet" href="style.css?v=6" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Top bar -->
  <div class="topbar">
    <div class="container topbar__inner">
      <span>EnvÃ­os a todo el paÃ­s Â· 3 y 6 cuotas sin interÃ©s</span>
      <a href="#contacto">Ayuda</a>
    </div>
  </div>

  <!-- Navbar -->
  <header class="nav">
    <div class="container nav__inner">
      <a href="#" class="logo">Nahuel<span>Electro</span></a>
      <div class="searchbox">
        <input id="searchInput" type="search" placeholder="Buscar: heladera, TV, lavarropas..." />
        <button id="searchBtn">Buscar</button>
      </div>
      <button id="openCart" class="cartbtn" aria-label="Abrir carrito">ðŸ›’<span id="cartCount" class="badge">0</span></button>
    </div>
  </header>

  <!-- Filtros -->
  <section class="filters">
    <div class="container filters__inner">
      <div class="selects">
        <select id="categoryFilter">
          <option value="all">Todas las categorÃ­as</option>
          <option value="Heladeras">Heladeras</option>
          <option value="Lavarropas">Lavarropas</option>
          <option value="Microondas">Microondas</option>
          <option value="Aires">Aires Acond.</option>
          <option value="TV">Smart TV</option>
          <option value="Cocinas">Cocinas</option>
          <option value="PequeÃ±os">PequeÃ±os</option>
        </select>
        <select id="sortBy">
          <option value="relevancia">Ordenar por: Relevancia</option>
          <option value="precio-asc">Precio: menor a mayor</option>
          <option value="precio-desc">Precio: mayor a menor</option>
          <option value="nombre-asc">Nombre Aâ†’Z</option>
        </select>
      </div>
      <div class="chips" id="promoChips">
        <button class="chip" data-chip="envio">ðŸšš EnvÃ­o gratis</button>
        <button class="chip" data-chip="cuotas">ðŸ’³ 6 cuotas</button>
        <button class="chip" data-chip="oferta">ðŸ”¥ Oferta</button>
        <button id="clearChips" class="link">Limpiar</button>
      </div>
    </div>
  </section>

  <!-- Grid de productos -->
  <main class="container">
    <h1>Ofertas destacadas</h1>
    <div id="productsGrid" class="grid"></div>
  </main>

  <!-- Carrito (drawer) -->
  <aside id="cartDrawer" class="cart">
    <div class="cart__header">
      <h3>Tu carrito</h3>
      <button id="closeCart" aria-label="Cerrar">âœ•</button>
    </div>
    <div id="cartItems" class="cart__items"></div>
    <div class="cart__footer">
      <div class="cart__row">
        <span>Total</span>
        <strong id="cartTotal">$ 0</strong>
      </div>
      <button id="checkoutBtn" class="btn btn--primary">Finalizar compra por WhatsApp</button>
      <button id="clearCart" class="btn btn--ghost">Vaciar carrito</button>
    </div>
  </aside>
  <div id="backdrop" class="backdrop"></div>

  <footer class="footer">
    <div class="container footer__inner">
      <p>Â© <span id="year"></span> Nahuel Electrohogar</p>
    </div>
  </footer>

  <script>
  // ================== Productos de ejemplo ==================
  const PRODUCTS = [
    { id: 1, name: "Heladera No Frost 360L Samsung", category: "Heladeras", price: 699999, img: "./img/heladera-samsung-360l.jpg", tags: ["envio","cuotas"] },
    { id: 2, name: "Smart TV 55\" 4K UHD LG", category: "TV", price: 679999, img: "./img/tv-lg-55-4k.jpg", tags: ["cuotas","oferta"] }
  ];

  const WHATSAPP_NUMBER = "5491127631167";

  // Helpers
  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => document.querySelectorAll(sel);
  const money = (n) => n.toLocaleString("es-AR", { style: "currency", currency: "ARS", maximumFractionDigits: 0 });

  // FunciÃ³n de cuota: (precio Ã— 2 + 10%) Ã· 4
  function cuota4(n){
    let totalFinanciado = n * 2 * 1.10;
    return totalFinanciado / 4;
  }

  // Render productos
  const grid = $("#productsGrid");
  function productCard(p){
    return `
      <article class="card">
        <img src="${p.img}" alt="${p.name}" class="card-img" loading="lazy">
        <div class="card-body">
          <h3 class="card-title">${p.name}</h3>
          <div class="price">4 cuotas de ${money(cuota4(p.price))}</div>
          <button class="btn btn--primary" data-add="${p.id}">Agregar</button>
        </div>
      </article>
    `;
  }
  function render(){
    grid.innerHTML = PRODUCTS.map(productCard).join("");
    $$("[data-add]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const id = Number(btn.getAttribute("data-add"));
        const prod = PRODUCTS.find(p=>p.id===id);
        addToCart(prod);
      });
    });
  }

  // Carrito
  let state = { cart: JSON.parse(localStorage.getItem("cart") || "[]") };
  const cartCount = $("#cartCount");
  const cartItems = $("#cartItems");
  const cartTotal = $("#cartTotal");
  const cartDrawer = $("#cartDrawer");
  const backdrop = $("#backdrop");

  function addToCart(prod){
    const found = state.cart.find(i=>i.id===prod.id);
    if (found) found.qty += 1;
    else state.cart.push({ id: prod.id, name: prod.name, price: prod.price, qty: 1 });
    persistCart(); openCart(); drawCart();
  }
  function persistCart(){
    localStorage.setItem("cart", JSON.stringify(state.cart));
    cartCount.textContent = state.cart.reduce((a,b)=>a+b.qty,0);
  }
  function drawCart(){
    if(!state.cart.length){
      cartItems.innerHTML = `<p class="muted">Tu carrito estÃ¡ vacÃ­o.</p>`;
      cartTotal.textContent = money(0);
      return;
    }
    cartItems.innerHTML = state.cart.map(i=>`
      <div class="cartline">
        <div>
          <strong>${i.name}</strong><br>
          <span>4 cuotas de ${money(cuota4(i.price))} (x${i.qty})</span>
        </div>
        <div>
          <button type="button" data-dec="${i.id}">âˆ’</button>
          <span>${i.qty}</span>
          <button type="button" data-inc="${i.id}">+</button>
        </div>
      </div>
    `).join("");

    const sub = state.cart.reduce((a,b)=>a + cuota4(b.price)*b.qty, 0);
    cartTotal.textContent = money(sub);
  }

  // Eventos carrito
  cartItems.onclick = (e) => {
    const t = e.target;
    if (t.matches("[data-inc]")) {
      const item = state.cart.find(i=>i.id==t.dataset.inc); item.qty++; persistCart(); drawCart();
    }
    if (t.matches("[data-dec]")) {
      const item = state.cart.find(i=>i.id==t.dataset.dec); if(item.qty>1) item.qty--; persistCart(); drawCart();
    }
  };
  function openCart(){ cartDrawer.classList.add("open"); backdrop.classList.add("show"); }
  function closeCart(){ cartDrawer.classList.remove("open"); backdrop.classList.remove("show"); }
  $("#openCart").addEventListener("click", openCart);
  $("#closeCart").addEventListener("click", closeCart);
  $("#backdrop").addEventListener("click", closeCart);

  $("#checkoutBtn").addEventListener("click", ()=>{
    if(!state.cart.length) return alert("El carrito estÃ¡ vacÃ­o.");
    let lines = state.cart.map(i => `â€¢ ${i.name} x${i.qty} â€” 4 cuotas de ${money(cuota4(i.price))}`).join("%0A");
    let msg = `Hola Nahuel, quiero comprar:%0A${lines}`;
    window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`, "_blank");
  });

  // Init
  persistCart(); drawCart(); render();
  document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</body>
</html>
