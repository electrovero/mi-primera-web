<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nahuel Electrohogar | Tienda de ElectrodomÃ©sticos</title>

  <!-- SEO bÃ¡sico -->
  <meta name="description" content="ElectrodomÃ©sticos con envÃ­o a todo el paÃ­s. Heladeras, lavarropas, TV, cocinas y mÃ¡s.">
  <meta property="og:title" content="Nahuel Electrohogar">
  <meta property="og:description" content="Ofertas, cuotas y envÃ­o en Argentina.">
  <meta property="og:type" content="website">

  <!-- Estilos -->
  <link rel="stylesheet" href="style.css?v=8" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Top bar -->
  <div class="topbar">
    <div class="container topbar__inner">
      <span>EnvÃ­os a todo el paÃ­s Â· 3 y 6 cuotas sin interÃ©s</span>
      <a href="#contacto">Ayuda</a>
    </div>
  </div>

  <!-- Navbar -->
  <header class="nav">
    <div class="container nav__inner">
      <a href="#" class="logo">Nahuel<span>Electro</span></a>

      <div class="searchbox">
        <input id="searchInput" type="search" placeholder="Buscar: heladera, TV, lavarropas..." />
        <button id="searchBtn">Buscar</button>
      </div>

      <button id="openCart" class="cartbtn" aria-label="Abrir carrito">ðŸ›’<span id="cartCount" class="badge">0</span></button>
    </div>
  </header>

  <!-- Filtros -->
  <section class="filters">
    <div class="container filters__inner">
      <div class="selects">
        <select id="categoryFilter">
          <option value="all">Todas las categorÃ­as</option>
          <option value="Heladeras">Heladeras</option>
          <option value="Lavarropas">Lavarropas</option>
          <option value="Microondas">Microondas</option>
          <option value="Aires">Aires Acond.</option>
          <option value="TV">Smart TV</option>
          <option value="Cocinas">Cocinas</option>
          <option value="PequeÃ±os">PequeÃ±os</option>
          <option value="Gaming">Gaming</option>
          <option value="Cuidado Personal">Cuidado Personal</option>
        </select>

        <select id="sortBy">
          <option value="relevancia">Ordenar por: Relevancia</option>
          <option value="precio-asc">Precio: menor a mayor</option>
          <option value="precio-desc">Precio: mayor a menor</option>
          <option value="nombre-asc">Nombre Aâ†’Z</option>
        </select>
      </div>

      <div class="chips" id="promoChips">
        <button class="chip" data-chip="envio">ðŸšš EnvÃ­o gratis</button>
        <button class="chip" data-chip="cuotas">ðŸ’³ 6 cuotas</button>
        <button class="chip" data-chip="oferta">ðŸ”¥ Oferta</button>
        <button id="clearChips" class="link">Limpiar</button>
      </div>
    </div>
  </section>

  <!-- Grid de productos -->
  <main class="container">
    <h1>Ofertas destacadas</h1>
    <div id="productsGrid" class="grid"></div>
  </main>

  <!-- Confianza / ventajas -->
  <section class="trust">
    <div class="container trust__inner">
      <div class="trust__item">âœ… GarantÃ­a oficial</div>
      <div class="trust__item">ðŸšš EnvÃ­o a todo el paÃ­s</div>
      <div class="trust__item">ðŸ”’ Compra segura</div>
      <div class="trust__item">ðŸ’¬ AtenciÃ³n por WhatsApp</div>
    </div>
  </section>

  <!-- Preguntas frecuentes -->
  <section class="container faq">
    <h2>Preguntas frecuentes</h2>
    <details>
      <summary>Â¿Hacen envÃ­os a todo el paÃ­s?</summary>
      <p>SÃ­, trabajamos con OCA/Andreani y transporte propio en AMBA.</p>
    </details>
    <details>
      <summary>Â¿Puedo pagar en cuotas?</summary>
      <p>3 y 6 cuotas sin interÃ©s con bancos adheridos. ConsultÃ¡ promos.</p>
    </details>
    <details>
      <summary>Â¿Tienen garantÃ­a?</summary>
      <p>Todos los productos cuentan con garantÃ­a oficial del fabricante.</p>
    </details>
  </section>

  <!-- Contacto -->
  <section id="contacto" class="container contact">
    <h2>Contacto</h2>
    <p>Â¿Duda puntual? Escribinos por WhatsApp y te respondemos al toque.</p>
    <a class="btn btn--whatsapp" id="whatsFloating" target="_blank" rel="noreferrer">ðŸ’¬ WhatsApp</a>
  </section>

  <!-- Carrito (drawer) -->
  <aside id="cartDrawer" class="cart">
    <div class="cart__header">
      <h3>Tu carrito</h3>
      <button id="closeCart" aria-label="Cerrar">âœ•</button>
    </div>
    <div id="cartItems" class="cart__items"></div>
    <div class="cart__footer">
      <div class="cart__row">
        <span>Subtotal</span>
        <strong id="cartSubtotal">$ 0</strong>
      </div>

      <!-- CupÃ³n (mini UI discreta) -->
      <div class="cart__row" style="justify-content:flex-start; gap:8px;">
        <button id="toggleCoupon" class="link" type="button" aria-expanded="false">Â¿TenÃ©s cupÃ³n?</button>
      </div>
      <div id="couponBox" style="display:none; gap:6px; margin:6px 0 2px 0;">
        <input id="couponInput" type="text" placeholder="IngresÃ¡ tu cupÃ³n" style="flex:1; background:#0c1426; border:1px solid var(--border); color:var(--text); padding:8px; border-radius:8px; outline:none;">
        <button id="applyCoupon" class="btn btn--ghost" type="button">Aplicar</button>
      </div>
      <div id="couponInfo" class="cart__row" style="display:none;">
        <span id="couponLabel">CupÃ³n aplicado</span>
        <strong id="couponValue">- $ 0</strong>
      </div>
      <!-- /CupÃ³n -->

      <div class="cart__total">
        <span>Total</span>
        <strong id="cartTotal">$ 0</strong>
      </div>
      <button id="checkoutBtn" class="btn btn--primary">Finalizar compra por WhatsApp</button>
      <button id="clearCart" class="btn btn--ghost">Vaciar carrito</button>
    </div>
  </aside>
  <div id="backdrop" class="backdrop"></div>

  <footer class="footer">
    <div class="container footer__inner">
      <p>Â© <span id="year"></span> Nahuel Electrohogar</p>
      <nav>
        <a href="#contacto">Contacto</a>
        <a href="#">TÃ©rminos</a>
        <a href="#">Privacidad</a>
      </nav>
    </div>
  </footer>

  <script>
  /* ================== Productos ================== */
  const PRODUCTS = [
    /* CatÃ¡logo propio */
    { id: 1, name: "Heladera No Frost 360L Samsung", category: "Heladeras", price: 699999, img: "./img/heladera-samsung-360l.jpg", tags: ["envio","cuotas"] },
    { id: 2, name: "Lavarropas AutomÃ¡tico 8kg LG Inverter", category: "Lavarropas", price: 589999, img: "./img/lavarropas-lg-8kg.jpg", tags: ["cuotas","envio"] },
    { id: 3, name: "Microondas BGH 28L Grill Inox", category: "Microondas", price: 149999, img: "./img/microondas-bgh-28l.jpg", tags: ["oferta","envio"] },
    { id: 4, name: "Smart TV 55\" 4K UHD LG", category: "TV", price: 679999, img: "./img/tv-lg-55-4k.jpg", tags: ["cuotas","oferta"] },
    { id: 5, name: "Aire Acondicionado Split 3000W FrÃ­o/Calor", category: "Aires", price: 799999, img: "./img/aire-split-3000w.jpg", tags: ["envio"] },
    { id: 6, name: "Pava ElÃ©ctrica Inox 1.7L", category: "PequeÃ±os", price: 45999, img: "./img/pava-inox-17.jpg", tags: ["oferta"] },
    { id: 7, name: "Aspiradora CiclÃ³nica 2000W", category: "PequeÃ±os", price: 119999, img: "./img/aspiradora-2000w.jpg", tags: ["cuotas"] },
    { id: 8, name: "Licuadora Oster 600W Jarra Vidrio", category: "PequeÃ±os", price: 79999, img: "./img/licuadora-oster-600w.jpg", tags: ["envio"] },
    { id: 9, name: "Tostadora ElÃ©ctrica Philips", category: "PequeÃ±os", price: 55999, img: "./img/tostadora-philips.jpg", tags: ["oferta"] },
    { id: 10, name: "Plancha a Vapor Philips 2200W", category: "PequeÃ±os", price: 69999, img: "./img/plancha-philips-2200w.jpg", tags: ["envio","cuotas"] },
    { id: 11, name: "Cocina Orbis 56cm Acero", category: "Cocinas", price: 459999, img: "./img/cocina-orbis-56cm.jpg", tags: ["oferta","envio"] },

    /* TVs propias */
    { id: 20, name: "TV RCA 50\"", category: "TV", price: 349999, img: "./img/tv-50-rca.jpg", tags: ["oferta","envio"] },
    { id: 21, name: "TV Noblex 100\"", category: "TV", price: 799999, img: "./img/tv-noblex-100.jpg", tags: ["cuotas","envio"] },
    { id: 22, name: "TV Noblex 75\"", category: "TV", price: 659999, img: "./img/tv-noblex-75.jpg", tags: ["oferta","cuotas"] },
    { id: 23, name: "TV Noblex Roku 43\"", category: "TV", price: 289999, img: "./img/tv-noblex-roku-43.jpg", tags: ["envio"] },
    { id: 24, name: "TV Philips 50\"", category: "TV", price: 359999, img: "./img/tv-philips-50.jpg", tags: ["oferta"] },
    { id: 25, name: "TV Philips 65\"", category: "TV", price: 459999, img: "./img/tv-philips-65.jpg", tags: ["cuotas","envio"] },
    { id: 26, name: "TV Quint 32\"", category: "TV", price: 159999, img: "./img/tv-quint-32.jpg", tags: ["envio"] },
    { id: 27, name: "TV Sharp 50\"", category: "TV", price: 329999, img: "./img/tv-sharp-50.jpg", tags: ["oferta"] },
    { id: 28, name: "TV TCL 43\"", category: "TV", price: 259999, img: "./img/tv-tcl-43.jpg", tags: ["envio","cuotas"] },
    { id: 29, name: "TV Xiaomi 86\"", category: "TV", price: 899999, img: "./img/tv-xiaomi-86.jpg", tags: ["oferta","cuotas","envio"] },

    /* MegaElectro (hotlink) */
    { id: 101, name: "Silla Gamer Star Vision sin Luz", category: "Gaming", price: 115000, img: "https://megaelectro.com.ar/storage/products/G80ApXVt8gQON9L23k7vQ1T92qG3Hq4tP3n48yZq.jpg", tags: ["oferta"] },
    { id: 102, name: "Plancha Liliana Secca Alizza RPS900", category: "Cuidado Personal", price: 25000, img: "https://megaelectro.com.ar/storage/products/JGZk9z4lkQsdl3oIhZ4cFZLjN6f2Z1u1pD8x90sM.jpg", tags: ["envio"] },
    { id: 103, name: "Balanza Personal de BaÃ±o Azana", category: "Cuidado Personal", price: 10500, img: "https://megaelectro.com.ar/storage/products/Wx9fTt8KkQqjJ1m23NzQbqZ8vQxqk20cL8w9f8vX.jpg", tags: ["oferta"] },
    { id: 104, name: "Microondas Winco Digital 20 LTS", category: "Microondas", price: 115000, img: "https://megaelectro.com.ar/storage/products/NHf1g2vXcQfQy4cWw7z1Rt6h3Q9t2i0eF9w8nPqU.jpg", tags: ["envio"] },
    { id: 105, name: "Aire Acondicionado Electra 2600W Inverter FrÃ­o/Calor", category: "Aires", price: 480000, img: "https://megaelectro.com.ar/storage/products/Qe82VqX1sN5uTq0m5cW9zNfL7i3gQ7tLkX8d1oXw.jpg", tags: ["cuotas","envio"] },
    { id: 106, name: "Aire Acondicionado PortÃ¡til Electra 3500W ON/OFF", category: "Aires", price: 489000, img: "https://megaelectro.com.ar/storage/products/We1sP9tLkQm6zH1u7Zq3Xf8gPq7tO2jYkL3sM9wX.jpg", tags: ["envio"] },
    { id: 107, name: "Smart TV Samsung 65\" OLED 4K QN65S90DAGCZB", category: "TV", price: 2800000, img: "https://megaelectro.com.ar/storage/products/Yq9sD7tKkWm2hN8f7Qx1Vq6gTn8jO2pHcR4sX9vM.jpg", tags: ["oferta","cuotas","envio"] },
    { id: 108, name: "Aspiradora Yelmo AS-3210 1100W con Bolsa y Accesorios 2.5L", category: "PequeÃ±os", price: 52900, img: "https://megaelectro.com.ar/storage/products/Zr8pF1nKqWl5mC7hV2qX9tNfJ4gO7pLxKk2sT6yQ.jpg", tags: ["envio"] }
  ];

  /* ================== Cupones ================== */
  // AIRESPLIT10: 10% SOLO categorÃ­a "Aires" (una vez por cliente)
  // 10 cupones globales 10% (una sola vez por cliente)
  const COUPONS = {
    "AIRESPLIT10": { type: "category", category: "Aires", percent: 0.10 },
    "MEGA10A": { type: "global", percent: 0.10 },
    "MEGA10B": { type: "global", percent: 0.10 },
    "MEGA10C": { type: "global", percent: 0.10 },
    "MEGA10D": { type: "global", percent: 0.10 },
    "MEGA10E": { type: "global", percent: 0.10 },
    "MEGA10F": { type: "global", percent: 0.10 },
    "MEGA10G": { type: "global", percent: 0.10 },
    "MEGA10H": { type: "global", percent: 0.10 },
    "MEGA10I": { type: "global", percent: 0.10 },
    "MEGA10J": { type: "global", percent: 0.10 }
  };

  // Helpers para marcar como usado por cliente (localStorage)
  const isCouponRedeemed = (code) => localStorage.getItem("coupon_redeemed_" + code) === "1";
  const redeemCoupon = (code) => localStorage.setItem("coupon_redeemed_" + code, "1");

  /* ================== Config rÃ¡pida ================== */
  const WHATSAPP_NUMBER = "5491127631167";

  /* ================== Helpers generales ================== */
  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => document.querySelectorAll(sel);
  const money = (n) => n.toLocaleString("es-AR", { style: "currency", currency: "ARS", maximumFractionDigits: 0 });

  /* ================== Estado/Render ================== */
  const grid = $("#productsGrid");
  let state = {
    q: "", category: "all", sort: "relevancia",
    chips: new Set(),
    cart: JSON.parse(localStorage.getItem("cart") || "[]"),
    couponCode: null,       // string mayÃºsculas
    couponDiscount: 0,      // monto descuento aplicado
  };

  function productCard(p){
    const chipBadges = p.tags.map(t => `<span class="badge badge--${t}">${t}</span>`).join("");
    return `
      <article class="card" data-category="${p.category}">
        <img src="${p.img}" alt="${p.name}" class="card-img" loading="lazy">
        <div class="card-body">
          <h3 class="card-title">${p.name}</h3>
          <div class="price">${money(p.price)}</div>
          <div class="badges">${chipBadges}</div>
          <button class="btn btn--primary" data-add="${p.id}">Agregar</button>
        </div>
      </article>
    `;
  }

  function applyFilters(list){
    let res = [...list];
    if (state.q.trim()){
      const q = state.q.toLowerCase();
      res = res.filter(p => (p.name + " " + p.category).toLowerCase().includes(q));
    }
    if (state.category !== "all") res = res.filter(p => p.category === state.category);
    if (state.chips.size) res = res.filter(p => [...state.chips].every(tag => p.tags.includes(tag)));
    switch(state.sort){
      case "precio-asc": res.sort((a,b)=>a.price-b.price); break;
      case "precio-desc": res.sort((a,b)=>b.price-a.price); break;
      case "nombre-asc": res.sort((a,b)=>a.name.localeCompare(b.name)); break;
    }
    return res;
  }

  function render(){
    const list = applyFilters(PRODUCTS);
    grid.innerHTML = list.map(productCard).join("") || `<p class="muted">No se encontraron productos.</p>`;
    $$("[data-add]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const id = Number(btn.getAttribute("data-add"));
        const prod = PRODUCTS.find(p=>p.id===id);
        addToCart(prod);
      });
    });
  }

  /* ================== Carrito ================== */
  const cartCount = $("#cartCount");
  const cartItems = $("#cartItems");
  const cartSubtotal = $("#cartSubtotal");
  const cartTotal = $("#cartTotal");
  const cartDrawer = $("#cartDrawer");
  const backdrop = $("#backdrop");

  const toggleCouponBtn = $("#toggleCoupon");
  const couponBox = $("#couponBox");
  const couponInput = $("#couponInput");
  const applyCouponBtn = $("#applyCoupon");
  const couponInfo = $("#couponInfo");
  const couponLabel = $("#couponLabel");
  const couponValue = $("#couponValue");

  function addToCart(prod){
    const found = state.cart.find(i=>i.id===prod.id);
    if (found) found.qty += 1; else state.cart.push({ id: prod.id, name: prod.name, category: prod.category, price: prod.price, qty: 1 });
    persistCart(); openCart(); drawCart();
  }
  function removeFromCart(id){
    state.cart = state.cart.filter(i=>i.id!==id);
    persistCart(); drawCart();
  }
  function changeQty(id, delta){
    const item = state.cart.find(i=>i.id===id);
    if(!item) return;
    item.qty = Math.max(1, item.qty + delta);
    persistCart(); drawCart();
  }
  function persistCart(){
    localStorage.setItem("cart", JSON.stringify(state.cart));
    cartCount.textContent = state.cart.reduce((a,b)=>a+b.qty,0);
  }

  function calcSubtotal(){
    return state.cart.reduce((a,b)=>a + b.price*b.qty, 0);
  }

  // LÃ³gica de cupones
  function canApplyCategoryCoupon(code, coupon){
    if (coupon.type !== "category") return true;
    // Debe haber al menos 1 Ã­tem de esa categorÃ­a en el carrito
    return state.cart.some(i => i.category === coupon.category);
  }

  function computeCouponDiscount(coupon){
    const subtotal = calcSubtotal();
    if (coupon.type === "global"){
      return Math.round(subtotal * coupon.percent);
    } else if (coupon.type === "category"){
      const catSum = state.cart
        .filter(i => i.category === coupon.category)
        .reduce((a,b)=> a + b.price*b.qty, 0);
      return Math.round(catSum * coupon.percent);
    }
    return 0;
  }

  function applyCouponCode(rawCode){
    const code = (rawCode || "").trim().toUpperCase();
    if (!code) return alert("IngresÃ¡ un cupÃ³n vÃ¡lido.");
    const coupon = COUPONS[code];
    if (!coupon) return alert("CupÃ³n invÃ¡lido.");
    if (isCouponRedeemed(code)) return alert("Este cupÃ³n ya fue utilizado.");

    if (!canApplyCategoryCoupon(code, coupon)){
      return alert(`El cupÃ³n aplica solo a la categorÃ­a ${coupon.category}. AgregÃ¡ un producto de esa categorÃ­a al carrito.`);
    }

    const discount = computeCouponDiscount(coupon);
    if (discount <= 0) return alert("No hay monto elegible para este cupÃ³n.");

    // Fijar estado: aplicamos y bloqueamos
    state.couponCode = code;
    state.couponDiscount = discount;
    redeemCoupon(code); // ðŸ”’ marca como usado para este cliente
    updateTotalsUI();
    couponInfo.style.display = "flex";
    couponLabel.textContent = `CupÃ³n aplicado (${code})`;
    couponValue.textContent = `- ${money(discount)}`;
    couponBox.style.display = "none";
    toggleCouponBtn.setAttribute("aria-expanded", "false");
    alert("Â¡CupÃ³n aplicado!");
  }

  function updateTotalsUI(){
    const subtotal = calcSubtotal();
    cartSubtotal.textContent = money(subtotal);
    const discount = state.couponDiscount || 0;
    const total = Math.max(0, subtotal - discount);
    cartTotal.textContent = money(total);
    if (state.couponCode){
      couponInfo.style.display = "flex";
      couponLabel.textContent = `CupÃ³n aplicado (${state.couponCode})`;
      couponValue.textContent = `- ${money(discount)}`;
    } else {
      couponInfo.style.display = "none";
    }
  }

  function drawCart(){
    if(!state.cart.length){
      cartItems.innerHTML = `<p class="muted">Tu carrito estÃ¡ vacÃ­o.</p>`;
      state.couponCode = null;
      state.couponDiscount = 0;
      updateTotalsUI();
      persistCart();
      return;
    }
    cartItems.innerHTML = state.cart.map(i=>`
      <div class="cartline">
        <div class="cartline__info">
          <strong>${i.name}</strong>
          <span>${money(i.price)}</span>
        </div>
        <div class="cartline__qty">
          <button type="button" data-dec="${i.id}">âˆ’</button>
          <span>${i.qty}</span>
          <button type="button" data-inc="${i.id}">+</button>
          <button type="button" class="link danger" data-del="${i.id}">Quitar</button>
        </div>
      </div>
    `).join("");

    // Recalcular descuento si hay cupÃ³n aplicado (por si cambiÃ³ el carrito)
    if (state.couponCode){
      const coupon = COUPONS[state.couponCode];
      if (coupon){
        state.couponDiscount = computeCouponDiscount(coupon);
      } else {
        state.couponCode = null;
        state.couponDiscount = 0;
      }
    }

    updateTotalsUI();
    persistCart();

    // DelegaciÃ³n: botones +/âˆ’/Quitar
    cartItems.onclick = (e) => {
      const t = e.target;
      if (t.matches("[data-inc]")) return changeQty(Number(t.dataset.inc), +1);
      if (t.matches("[data-dec]")) return changeQty(Number(t.dataset.dec), -1);
      if (t.matches("[data-del]")) return removeFromCart(Number(t.dataset.del));
    };
  }

  function openCart(){ cartDrawer.classList.add("open"); backdrop.classList.add("show"); document.body.classList.add("noscroll"); }
  function closeCart(){ cartDrawer.classList.remove("open"); backdrop.classList.remove("show"); document.body.classList.remove("noscroll"); }

  // WhatsApp checkout
  function buildWhatsappLink(){
    if(!state.cart.length) return null;
    const lines = state.cart.map(i => `â€¢ ${i.name} x${i.qty} â€” ${money(i.price*i.qty)}`).join("%0A");
    const subtotal = calcSubtotal();
    const discount = state.couponDiscount || 0;
    const total = Math.max(0, subtotal - discount);
    const couponLine = state.couponCode ? `%0ACupÃ³n: ${state.couponCode} (âˆ’${money(discount)})` : "";
    const msg = `Hola Nahuel, quiero comprar:%0A${lines}%0A%0ASubtotal: ${money(subtotal)}${couponLine}%0ATotal: ${money(total)}%0A%0ADatos de envÃ­o:`;
    return `https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`;
  }

  // Eventos carrito
  $("#checkoutBtn").addEventListener("click", ()=>{
    const url = buildWhatsappLink();
    if(!url) return alert("El carrito estÃ¡ vacÃ­o.");
    window.open(url, "_blank");
  });
  $("#clearCart").addEventListener("click", ()=>{ state.cart = []; persistCart(); drawCart(); });
  $("#openCart").addEventListener("click", openCart);
  $("#closeCart").addEventListener("click", closeCart);
  $("#backdrop").addEventListener("click", closeCart);

  // CupÃ³n UI discreta
  toggleCouponBtn.addEventListener("click", ()=>{
    const open = couponBox.style.display === "flex";
    couponBox.style.display = open ? "none" : "flex";
    toggleCouponBtn.setAttribute("aria-expanded", String(!open));
    if (!open) couponInput.focus();
  });
  applyCouponBtn.addEventListener("click", ()=> applyCouponCode(couponInput.value));
  couponInput.addEventListener("keydown", (e)=>{ if(e.key === "Enter") applyCouponCode(couponInput.value); });

  /* ================== BÃºsqueda / Filtros ================== */
  $("#searchBtn").addEventListener("click", ()=>{ state.q = $("#searchInput").value || ""; render(); });
  $("#searchInput").addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ state.q = e.target.value; render(); }});
  $("#categoryFilter").addEventListener("change", (e)=>{ state.category = e.target.value; render(); });
  $("#sortBy").addEventListener("change", (e)=>{ state.sort = e.target.value; render(); });

  $$("#promoChips .chip").forEach(ch=>{
    ch.addEventListener("click", ()=>{
      const t = ch.dataset.chip;
      if(state.chips.has(t)) state.chips.delete(t); else state.chips.add(t);
      ch.classList.toggle("chip--active");
      render();
    });
  });
  $("#clearChips").addEventListener("click", ()=>{
    state.chips.clear();
    $$("#promoChips .chip").forEach(ch=>ch.classList.remove("chip--active"));
    render();
  });

  // WhatsApp flotante y aÃ±o
  const wlink = `https://wa.me/${WHATSAPP_NUMBER}?text=Hola Nahuel, tengo una consulta`;
  $("#whatsFloating").setAttribute("href", wlink);
  document.getElementById("year").textContent = new Date().getFullYear();

  // Init
  persistCart(); drawCart(); render();
  </script>
</body>
</html>
