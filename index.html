<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nahuel Electrohogar | Tienda de ElectrodomÃ©sticos</title>

  <!-- SEO bÃ¡sico -->
  <meta name="description" content="ElectrodomÃ©sticos con envÃ­o a todo el paÃ­s. Heladeras, lavarropas, TV, cocinas y mÃ¡s.">
  <meta property="og:title" content="Nahuel Electrohogar">
  <meta property="og:description" content="Ofertas, cuotas y envÃ­o en Argentina.">
  <meta property="og:type" content="website">

  <!-- Estilos (usÃ¡ tu style.css existente) -->
  <link rel="stylesheet" href="style.css?v=coupon-manual-1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Estilos mÃ­nimos para el modal (si tu CSS ya lo tiene, podÃ©s quitar este bloque) -->
  <style>
    .modal{ position: fixed; inset: 0; z-index: 120; display: none; place-items: center; }
    .modal.show{ display: grid; }
    .modal__content{
      background: var(--card, #111827); border: 1px solid var(--border, #1f2937); border-radius: 16px;
      width: min(920px, 96vw); max-height: 92vh; overflow: hidden;
      display: grid; grid-template-columns: 1fr; gap: 0;
    }
    @media(min-width: 860px){ .modal__content{ grid-template-columns: 1.1fr 1fr; } }
    .modal__img{ width:100%; height:100%; max-height:60vh; object-fit:cover; display:block; background:#111; }
    .modal__body{ padding:16px; display:flex; flex-direction:column; gap:12px; }
    .modal__title{ margin:0; font-size:20px; }
    .modal__price{ font-size:18px; font-weight:700; }
    .modal__desc{ color: var(--muted, #9ca3af); line-height:1.5; }
    .modal__actions{ display:flex; gap:8px; flex-wrap:wrap; }
    .modal__close{
      position:absolute; top:10px; right:10px;
      background:#0c1426; border:1px solid var(--border, #1f2937); color:var(--text, #e5e7eb);
      border-radius:10px; padding:6px 10px; cursor:pointer;
    }
    #modalBackdrop{ z-index:110; }
  </style>
</head>
<body>
  <!-- Top bar -->
  <div class="topbar">
    <div class="container topbar__inner">
      <span>EnvÃ­os a todo el paÃ­s Â· 3 y 6 cuotas sin interÃ©s</span>
      <a href="#contacto">Ayuda</a>
    </div>
  </div>

  <!-- Navbar -->
  <header class="nav">
    <div class="container nav__inner">
      <a href="#" class="logo">Nahuel<span>Electro</span></a>

      <div class="searchbox">
        <input id="searchInput" type="search" placeholder="Buscar: heladera, TV, lavarropas..." />
        <button id="searchBtn">Buscar</button>
      </div>

      <button id="openCart" class="cartbtn" aria-label="Abrir carrito">ðŸ›’<span id="cartCount" class="badge">0</span></button>
    </div>
  </header>

  <!-- Filtros -->
  <section class="filters">
    <div class="container filters__inner">
      <div class="selects">
        <select id="categoryFilter">
          <option value="all">Todas las categorÃ­as</option>
          <!-- Se completa solo -->
        </select>

        <select id="sortBy">
          <option value="relevancia">Ordenar por: Relevancia</option>
          <option value="precio-asc">Precio: menor a mayor</option>
          <option value="precio-desc">Precio: mayor a menor</option>
          <option value="nombre-asc">Nombre Aâ†’Z</option>
        </select>
      </div>

      <div class="chips" id="promoChips">
        <button class="chip" data-chip="envio">ðŸšš EnvÃ­o gratis</button>
        <button class="chip" data-chip="cuotas">ðŸ’³ 6 cuotas</button>
        <button class="chip" data-chip="oferta">ðŸ”¥ Oferta</button>
        <button id="clearChips" class="link">Limpiar</button>
      </div>
    </div>
  </section>

  <!-- Grid de productos -->
  <main class="container">
    <h1>Ofertas destacadas</h1>
    <div id="productsGrid" class="grid"></div>
  </main>

  <!-- Confianza / ventajas -->
  <section class="trust">
    <div class="container trust__inner">
      <div class="trust__item">âœ… GarantÃ­a oficial</div>
      <div class="trust__item">ðŸšš EnvÃ­o a todo el paÃ­s</div>
      <div class="trust__item">ðŸ”’ Compra segura</div>
      <div class="trust__item">ðŸ’¬ AtenciÃ³n por WhatsApp</div>
    </div>
  </section>

  <!-- Preguntas frecuentes -->
  <section class="container faq">
    <h2>Preguntas frecuentes</h2>
    <details>
      <summary>Â¿Hacen envÃ­os a todo el paÃ­s?</summary>
      <p>SÃ­, trabajamos con OCA/Andreani y transporte propio en AMBA.</p>
    </details>
    <details>
      <summary>Â¿Puedo pagar en cuotas?</summary>
      <p>3 y 6 cuotas sin interÃ©s con bancos adheridos. ConsultÃ¡ promos.</p>
    </details>
    <details>
      <summary>Â¿Tienen garantÃ­a?</summary>
      <p>Todos los productos cuentan con garantÃ­a oficial del fabricante.</p>
    </details>
  </section>

  <!-- Contacto -->
  <section id="contacto" class="container contact">
    <h2>Contacto</h2>
    <p>Â¿Duda puntual? Escribinos por WhatsApp y te respondemos al toque.</p>
    <a class="btn btn--whatsapp" id="whatsFloating" target="_blank" rel="noreferrer">ðŸ’¬ WhatsApp</a>
  </section>

  <!-- Carrito (drawer) -->
  <aside id="cartDrawer" class="cart">
    <div class="cart__header">
      <h3>Tu carrito</h3>
      <button id="closeCart" aria-label="Cerrar">âœ•</button>
    </div>
    <div id="cartItems" class="cart__items"></div>
    <div class="cart__footer">
      <div class="cart__row">
        <span>Subtotal</span>
        <strong id="cartSubtotal">$ 0</strong>
      </div>

      <!-- Descuento: se muestra solo si aplica -->
      <div class="cart__row" id="discountRow" style="display:none">
        <span>Descuento</span>
        <strong id="cartDiscount">- $ 0</strong>
      </div>

      <div class="cart__total">
        <span>Total</span>
        <strong id="cartTotal">$ 0</strong>
      </div>

      <!-- Campo de cupÃ³n (manual) -->
      <div style="margin-top:10px">
        <input id="couponInput" type="text" placeholder="CÃ³digo de descuento" autocomplete="off" style="width:100%;padding:8px;border-radius:8px;border:1px solid #444;background:#111;color:#fff">
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="applyCouponBtn" class="btn btn--primary">Aplicar cupÃ³n</button>
          <button id="removeCouponBtn" class="btn btn--ghost" style="display:none">Quitar cupÃ³n</button>
        </div>
        <p id="couponMsg" style="color:#ef4444;margin:6px 0 0;font-size:14px"></p>
      </div>

      <button id="checkoutBtn" class="btn btn--primary" style="margin-top:12px">Finalizar compra por WhatsApp</button>
      <button id="clearCart" class="btn btn--ghost">Vaciar carrito</button>
    </div>
  </aside>
  <div id="backdrop" class="backdrop"></div>

  <!-- Modal producto -->
  <div id="modalBackdrop" class="backdrop"></div>
  <div id="productModal" class="modal">
    <button id="modalClose" class="modal__close" aria-label="Cerrar">âœ•</button>
    <div class="modal__content">
      <img id="modalImg" alt="" class="modal__img">
      <div class="modal__body">
        <h3 id="modalTitle" class="modal__title"></h3>
        <div id="modalPrice" class="modal__price"></div>
        <p id="modalDesc" class="modal__desc"></p>
        <div class="modal__actions">
          <button id="modalAdd" class="btn btn--primary">Agregar al carrito</button>
          <button id="modalGoCart" class="btn btn--ghost">Ver carrito</button>
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container footer__inner">
      <p>Â© <span id="year"></span> Nahuel Electrohogar</p>
      <nav>
        <a href="#contacto">Contacto</a>
        <a href="#">TÃ©rminos</a>
        <a href="#">Privacidad</a>
      </nav>
    </div>
  </footer>

  <script>
  /* ================== CatÃ¡logo (ejemplo) ================== */
  const PRODUCTS = [
    { id: 1,  name: "Heladera No Frost 360L Samsung", category: "Heladeras", price: 699999, img: "./img/heladera-samsung-360l.jpg", tags: ["envio","cuotas"] },
    { id: 2,  name: "Lavarropas AutomÃ¡tico 8kg LG Inverter", category: "Lavarropas", price: 589999, img: "./img/lavarropas-lg-8kg.jpg", tags: ["cuotas","envio"] },
    { id: 3,  name: "Microondas BGH 28L Grill Inox", category: "Microondas", price: 149999, img: "./img/microondas-bgh-28l.jpg", tags: ["oferta","envio"] },
    { id: 4,  name: "Smart TV 55\" 4K UHD LG", category: "TV", price: 679999, img: "./img/tv-lg-55-4k.jpg", tags: ["cuotas","oferta"] }
  ];

  /* ================== Cupones (10%, uso Ãºnico) ================== */
  const COUPONS = {
    "AHORRO10A": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10B": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10C": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10D": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10E": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10F": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10G": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10H": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10I": { type: "percent", value: 10, expires: "2030-12-31" },
    "AHORRO10J": { type: "percent", value: 10, expires: "2030-12-31" }
  };

  /* ================== Config rÃ¡pida ================== */
  const WHATSAPP_NUMBER = "5491127631167"; // tu nÃºmero sin + ni 00

  /* ================== Helpers ================== */
  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => document.querySelectorAll(sel);
  const money = (n) => n.toLocaleString("es-AR", { style: "currency", currency: "ARS", maximumFractionDigits: 0 });
  function isExpired(dateStr){ return new Date(dateStr) < new Date(); }

  /* ====== Un solo uso por navegador ====== */
  const USED_KEY = "usedCoupons";
  function getUsedCoupons(){ try { return JSON.parse(localStorage.getItem(USED_KEY) || "[]"); } catch { return []; } }
  function isCodeUsed(code){ return getUsedCoupons().includes(code); }
  function markCodeUsed(code){
    if(!code) return;
    const list = getUsedCoupons();
    if(!list.includes(code)){
      list.push(code);
      localStorage.setItem(USED_KEY, JSON.stringify(list));
    }
  }

  /* ================== Estado/Render ================== */
  const grid = $("#productsGrid");
  let state = {
    q: "", category: "all", sort: "relevancia",
    chips: new Set(),
    cart: JSON.parse(localStorage.getItem("cart") || "[]"),
    coupon: JSON.parse(localStorage.getItem("coupon") || "null") // { code }
  };

  function productCard(p){
    const chipBadges = p.tags.map(t => `<span class="badge badge--${t}">${t}</span>`).join("");
    return `
      <article class="card">
        <img src="${p.img}" alt="${p.name}" class="card-img" loading="lazy" data-view="${p.id}">
        <div class="card-body">
          <h3 class="card-title">${p.name}</h3>
          <div class="price">${money(p.price)}</div>
          <div class="badges">${chipBadges}</div>
          <div style="display:flex; gap:8px; flex-wrap:wrap">
            <button class="btn btn--primary" data-add="${p.id}">Agregar</button>
            <button class="btn btn--ghost" data-view="${p.id}">Ver detalle</button>
          </div>
        </div>
      </article>
    `;
  }

  function applyFilters(list){
    let res = [...list];
    if (state.q.trim()){
      const q = state.q.toLowerCase();
      res = res.filter(p => (p.name + " " + p.category).toLowerCase().includes(q));
    }
    if (state.category !== "all") res = res.filter(p => p.category === state.category);
    if (state.chips.size) res = res.filter(p => [...state.chips].every(tag => p.tags.includes(tag)));
    switch(state.sort){
      case "precio-asc": res.sort((a,b)=>a.price-b.price); break;
      case "precio-desc": res.sort((a,b)=>b.price-a.price); break;
      case "nombre-asc": res.sort((a,b)=>a.name.localeCompare(b.name)); break;
    }
    return res;
  }

  function render(){
    const list = applyFilters(PRODUCTS);
    grid.innerHTML = list.map(productCard).join("") || `<p class="muted">No se encontraron productos.</p>`;
    $$("[data-add]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const id = Number(btn.getAttribute("data-add"));
        const prod = PRODUCTS.find(p=>p.id===id);
        addToCart(prod);
      });
    });
  }

  /* ================== Descripciones base para modal ================== */
  function getDesc(p){
    const base = {
      "Heladeras": "Eficiencia y capacidad para tu hogar. GarantÃ­a oficial.",
      "Lavarropas": "TecnologÃ­a inverter con bajo consumo.",
      "Microondas": "CocciÃ³n rÃ¡pida y funciones grill.",
      "TV": "Smart TV con apps y conectividad."
    };
    return p.desc || base[p.category] || "Producto de calidad con garantÃ­a y soporte.";
  }

  /* ================== Carrito ================== */
  const cartCount = $("#cartCount");
  const cartItems = $("#cartItems");
  const cartSubtotal = $("#cartSubtotal");
  const cartTotal = $("#cartTotal");
  const cartDrawer = $("#cartDrawer");
  const backdrop = $("#backdrop");

  function addToCart(prod){
    const found = state.cart.find(i=>i.id===prod.id);
    if (found) found.qty += 1; else state.cart.push({ id: prod.id, name: prod.name, price: prod.price, qty: 1 });
    persistCart(); drawCart();
  }
  function removeFromCart(id){
    state.cart = state.cart.filter(i=>i.id!==id);
    persistCart(); drawCart();
  }
  function changeQty(id, delta){
    const item = state.cart.find(i=>i.id===id);
    if(!item) return;
    item.qty = Math.max(1, item.qty + delta);
    persistCart(); drawCart();
  }
  function persistCart(){
    localStorage.setItem("cart", JSON.stringify(state.cart));
    if(state.coupon) localStorage.setItem("coupon", JSON.stringify(state.coupon));
    cartCount.textContent = state.cart.reduce((a,b)=>a+b.qty,0);
  }

  function calcDiscount(){
    const code = state.coupon?.code;
    if(!code) return { discount: 0, reason: null };
    if(isCodeUsed(code)) return { discount: 0, reason: "Este cupÃ³n ya fue utilizado en este dispositivo." };
    const rule = COUPONS[code];
    if(!rule) return { discount: 0, reason: "CupÃ³n invÃ¡lido." };
    if(isExpired(rule.expires)) return { discount: 0, reason: "CupÃ³n vencido." };

    const subtotal = state.cart.reduce((a,b)=>a + b.price*b.qty, 0);
    let discount = 0;
    if(rule.type === "percent") discount = Math.round(subtotal * (rule.value/100));
    else if(rule.type === "fixed") discount = Math.min(rule.value, subtotal);
    return { discount, reason: null };
  }

  function drawCart(){
    if(!state.cart.length){
      cartItems.innerHTML = `<p class="muted">Tu carrito estÃ¡ vacÃ­o.</p>`;
      cartSubtotal.textContent = money(0);
      document.getElementById("discountRow").style.display = "none";
      document.getElementById("cartDiscount").textContent = "- $ 0";
      cartTotal.textContent = money(0);
      return;
    }
    cartItems.innerHTML = state.cart.map(i=>`
      <div class="cartline">
        <div class="cartline__info">
          <strong>${i.name}</strong>
          <span>${money(i.price)}</span>
        </div>
        <div class="cartline__qty">
          <button type="button" data-dec="${i.id}">âˆ’</button>
          <span>${i.qty}</span>
          <button type="button" data-inc="${i.id}">+</button>
          <button type="button" class="link danger" data-del="${i.id}">Quitar</button>
        </div>
      </div>
    `).join("");

    const sub = state.cart.reduce((a,b)=>a + b.price*b.qty, 0);
    cartSubtotal.textContent = money(sub);

    const { discount, reason } = calcDiscount();
    const discountRow = document.getElementById("discountRow");
    const cartDiscount = document.getElementById("cartDiscount");
    const couponMsg = document.getElementById("couponMsg");

    couponMsg.textContent = "";
    if(state.coupon && discount > 0 && !reason){
      discountRow.style.display = "flex";
      cartDiscount.textContent = `- ${money(discount)}`;
    }else{
      discountRow.style.display = "none";
      cartDiscount.textContent = "- $ 0";
      if(reason) couponMsg.textContent = reason;
    }

    const total = Math.max(0, sub - (discount || 0));
    cartTotal.textContent = money(total);
  }

  // DelegaciÃ³n de eventos del carrito
  cartItems.onclick = (e) => {
    const t = e.target;
    if (t.matches("[data-inc]")) return changeQty(Number(t.dataset.inc), +1);
    if (t.matches("[data-dec]")) return changeQty(Number(t.dataset.dec), -1);
    if (t.matches("[data-del]")) return removeFromCart(Number(t.dataset.del));
  };

  function openCart(){ cartDrawer.classList.add("open"); backdrop.classList.add("show"); document.body.classList.add("noscroll"); }
  function closeCart(){ cartDrawer.classList.remove("open"); backdrop.classList.remove("show"); document.body.classList.remove("noscroll"); }
  $("#openCart").addEventListener("click", openCart);
  $("#closeCart").addEventListener("click", closeCart);
  $("#backdrop").addEventListener("click", closeCart);

  // Aplicar / Quitar cupÃ³n (manual)
  $("#applyCouponBtn").addEventListener("click", ()=>{
    const code = $("#couponInput").value.trim().toUpperCase();
    const msg = $("#couponMsg");
    if(!code){ msg.textContent = "IngresÃ¡ un cÃ³digo."; return; }
    if(isCodeUsed(code)){ msg.textContent = "Este cupÃ³n ya fue utilizado en este dispositivo."; return; }
    const rule = COUPONS[code];
    if(!rule){ msg.textContent = "CupÃ³n invÃ¡lido."; return; }
    if(isExpired(rule.expires)){ msg.textContent = "CupÃ³n vencido."; return; }

    state.coupon = { code };
    msg.textContent = "";
    $("#applyCouponBtn").style.display = "none";
    $("#removeCouponBtn").style.display = "inline-block";
    persistCart(); drawCart();
  });

  $("#removeCouponBtn").addEventListener("click", ()=>{
    state.coupon = null;
    localStorage.removeItem("coupon");
    $("#couponInput").value = "";
    $("#couponMsg").textContent = "";
    $("#applyCouponBtn").style.display = "inline-block";
    $("#removeCouponBtn").style.display = "none";
    drawCart();
  });

  // Checkout (marca cupÃ³n como usado si aplicÃ³ descuento)
  function buildWhatsappLink(){
    if(!state.cart.length) return null;
    const lines = state.cart.map(i => `â€¢ ${i.name} x${i.qty} â€” ${money(i.price*i.qty)}`).join("%0A");
    const subtotal = state.cart.reduce((a,b)=>a+b.price*b.qty,0);
    const { discount } = calcDiscount();
    const total = Math.max(0, subtotal - (discount || 0));
    const couponLine = state.coupon && discount ? `%0ADescuento (${state.coupon.code}): - ${money(discount)}` : "";
    const msg = `Hola Nahuel, quiero comprar:%0A${lines}%0A%0ASubtotal: ${money(subtotal)}${couponLine}%0ATotal: ${money(total)}%0A%0ADatos de envÃ­o:`;
    return `https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`;
  }

  $("#checkoutBtn").addEventListener("click", ()=>{
    const url = buildWhatsappLink();
    if(!url) return alert("El carrito estÃ¡ vacÃ­o.");
    // Si hay cupÃ³n con descuento, lo marcamos como usado y lo limpiamos
    const code = state.coupon?.code || null;
    const { discount } = calcDiscount();
    if(code && discount > 0){
      markCodeUsed(code);                 // se quema en este navegador
      state.coupon = null;
      localStorage.removeItem("coupon");
    }
    window.open(url, "_blank");
  });

  $("#clearCart").addEventListener("click", ()=>{
    state.cart = [];
    persistCart(); drawCart();
  });

  /* ================== BÃºsqueda / Filtros ================== */
  $("#searchBtn").addEventListener("click", ()=>{ state.q = $("#searchInput").value || ""; render(); });
  $("#searchInput").addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ state.q = e.target.value; render(); }});
  $("#categoryFilter").addEventListener("change", (e)=>{ state.category = e.target.value; render(); });
  $("#sortBy").addEventListener("change", (e)=>{ state.sort = e.target.value; render(); });

  $$("#promoChips .chip").forEach(ch=>{
    ch.addEventListener("click", ()=>{
      const t = ch.dataset.chip;
      if(state.chips.has(t)) state.chips.delete(t); else state.chips.add(t);
      ch.classList.toggle("chip--active");
      render();
    });
  });
  $("#clearChips").addEventListener("click", ()=>{ state.chips.clear(); $$("#promoChips .chip").forEach(ch=>ch.classList.remove("chip--active")); render(); });

  // WhatsApp flotante y aÃ±o
  const wlink = `https://wa.me/${WHATSAPP_NUMBER}?text=Hola Nahuel, tengo una consulta`;
  $("#whatsFloating").setAttribute("href", wlink);
  document.getElementById("year").textContent = new Date().getFullYear();

  /* ===== Modal de producto ===== */
  let MODAL_PROD = null;
  const modal = document.getElementById("productModal");
  const modalBackdrop = document.getElementById("modalBackdrop");
  function showProduct(p){
    MODAL_PROD = p;
    document.getElementById("modalImg").src = p.img;
    document.getElementById("modalImg").alt = p.name;
    document.getElementById("modalTitle").textContent = p.name;
    document.getElementById("modalPrice").textContent = money(p.price);
    document.getElementById("modalDesc").textContent = getDesc(p);
    modal.classList.add("show");
    modalBackdrop.classList.add("show");
    document.body.classList.add("noscroll");
  }
  function hideProduct(){
    modal.classList.remove("show");
    modalBackdrop.classList.remove("show");
    document.body.classList.remove("noscroll");
    MODAL_PROD = null;
  }
  document.getElementById("modalClose").addEventListener("click", hideProduct);
  modalBackdrop.addEventListener("click", hideProduct);
  document.addEventListener("keydown", (e)=>{ if(e.key === "Escape" && modal.classList.contains("show")) hideProduct(); });
  document.getElementById("modalAdd").addEventListener("click", ()=>{ if(!MODAL_PROD) return; addToCart(MODAL_PROD); });
  document.getElementById("modalGoCart").addEventListener("click", ()=>{ hideProduct(); openCart(); });

  // Abrir modal al click en imagen o botÃ³n "Ver detalle"
  grid.addEventListener("click", (e)=>{
    const btn = e.target.closest("[data-view]");
    if(!btn) return;
    const id = Number(btn.getAttribute("data-view"));
    const prod = PRODUCTS.find(p => p.id === id);
    if (prod) showProduct(prod);
  });

  /* ===== Poblar categorÃ­as automÃ¡ticamente ===== */
  function populateCategories(){
    const select = document.getElementById("categoryFilter");
    [...select.querySelectorAll('option:not([value="all"])')].forEach(o => o.remove());
    const cats = [...new Set(PRODUCTS.map(p => p.category))].sort((a,b)=>a.localeCompare(b));
    cats.forEach(cat => {
      const opt = document.createElement("option");
      opt.value = cat; opt.textContent = cat;
      select.appendChild(opt);
    });
  }

  // Init
  populateCategories();
  persistCart(); drawCart(); render();
  </script>
</body>
</html>
